
@{
    ViewBag.Title = "Sales Invoice";
}
<div class="row">
    <div class="col-md-12 col-lg-12 col-sm-12">
        <div class="box box-default panel-body">
            <div class="modal inmodal fade" id="myModal" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cancel</span></button>
                            <h4 class="modal-title">Add Item</h4>
                            <small class="font-bold"></small>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Item : </label>
                                <select class="form-control">
                                    <option value="a">J030</option>
                                    <option value="b">J031</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Description : </label>
                                <textarea class="form-control" disabled></textarea>
                            </div>
                            <div class="form-group">
                                <label>Qty : </label>
                                <input type="number" min="0" class="form-control" />
                            </div>
                            <div class="form-group">
                                <label>Unit Price : </label>
                                <div class="input-group">
                                    <span class="input-group-addon">Rp</span>
                                    <input type="number" min="0" class="form-control" />
                                </div>

                            </div>
                            <div class="form-group">
                                <label>Sub Total : </label>
                                <div class="input-group">
                                    <span class="input-group-addon">Rp</span>
                                    <input type="number" min="0" class="form-control" disabled />
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-white" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
            <form>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="InvoiceNo">Invoice No: </label>
                        <input name="InvoiceNo" type="text" class="form-control" />
                    </div>
                    <div class="form-group  col-md-6">
                        <label>Invoice Date : </label>
                        <input type="date" class="form-control" />
                    </div>
                    <div class="form-group col-md-12">
                        <label>Terms : </label>
                        <select class="form-control">
                            <option value="1">COD</option>
                            <option value="2">Transfer</option>
                        </select>
                    </div>
                    <div class="form-group col-md-6">
                        <label>Bill To : </label>
                        <textarea class="form-control" readonly rows="4"></textarea>
                    </div>
                    <div class="form-group col-md-6">
                        <label>Description : </label>
                        <textarea class="form-control" rows="4"></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-lg-12 col-sm-12">
                        <center><h3>Detail Sales Invoice</h3></center>
                        <hr />
                        <table id="myTable" class="table table-hover table-bordered">
                            <thead>
                                <tr>
                                    <th class="col-md-2">Item</th>
                                    <th class="col-md-2">Description</th>
                                    <th class="col-md-2">Qty</th>
                                    <th class="col-md-2">Unit Price</th>
                                    <th class="col-md-2">Sub Total</th>
                                    <th class="col-md-2">Action</th>
                                </tr>
                            </thead>
                            <tfoot>
                                <tr>
                                    <th colspan="4" style="text-align:right">Total Order:</th>
                                    <th colspan="2"></th>
                                </tr>
                                <tr>
                                    <th colspan="4" style="text-align:right">Discount:</th>
                                    <th colspan="2"><input class="text-left" type="number" value="0" id="discount" /></th>
                                </tr>
                                <tr>
                                    <th colspan="4" style="text-align:right">Ship Fee:</th>
                                    <th colspan="2"><input class="text-left" type="number" value="0" id="shipfee" /></th>
                                </tr>
                                <tr>
                                    <th colspan="4" style="text-align:right">Grand Total:</th>
                                    <th colspan="2" id="grandtotal"></th>
</tfoot>
                            <tbody>
                                <tr>
                                    <td>J030</td>
                                    <td>Brosur A4 AP150 2 sisi</td>
                                    <td>10000</td>
                                    <td>280.3</td>
                                    <td>Rp. 170750</td>
                                    <td><button type="button" class="btn btn-warning btn_edit" data-toggle="modal" data-target="#myModal">Edit</button> <button type="button" class="btn btn-danger">Delete</button></td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="btn btn-warning btn-primary pull-right" data-toggle="modal" data-target="#myModal">Add Item</button>
                    </div>
                    <div class="col-md-12">
                        <br />
                        <a href="@Url.Action("Index","PurchaseOrder")"><button class="btn btn-lg btn-success pull-right" style="margin-left:10px;">Save</button></a>
                        <a href="@Url.Action("Index","PurchaseOrder")"><button class="btn btn-lg btn-default pull-right">Cancel</button></a>
                    </div>
                </div>
            </form>
        </div>
    </div>

</div>

<script type="text/javascript">
    $(document).ready(function () {
        $('.btn_edit').click(function () {
            $('#myModal h4').html('Edit Item');
        });
        $('#btn_add').click(function () {
            $('#myModal h4').html('Add Item');
        });
        $('#myTable').DataTable({
            "footerCallback": function (row, data, start, end, display) {
                var api = this.api(), data;

                // Remove the formatting to get integer data for summation
                var intVal = function (i) {
                    return typeof i === 'string' ?
                        i.replace('Rp. ', '') * 1 :
                        typeof i === 'number' ?
                        i : 0;
                };

                // Total over all pages
                total = api
                    .column(4)
                    .data()
                    .reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                dp = $('#discount').val();
                sf = $('#shipfee').val();

                //// Total over this page
                //pageTotal = api
                //    .column(4, { page: 'current' })
                //    .data()
                //    .reduce(function (a, b) {
                //        return intVal(a) + intVal(b);
                //    }, 0);

                // Update footer
                $(api.column(4).footer()).html(
                    'Rp. ' + total
                );

                grandtotal = intVal(total) + intVal(sf) - dp;

                $('#grandtotal').html('Rp. ' + grandtotal);
            }
        });
    });
</script>
